{"case_name": "moe_distribute_combine_test_tiling_shared_expert_x_0", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [64, 7168], "origin_shape": [64, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 7], "origin_shape": [8, 7]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [192], "origin_shape": [192]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8], "origin_shape": [8]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [8, 7], "origin_shape": [8, 7]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [1], "origin_shape": [1]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 8}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 7}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 1}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 1}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": false, "expectTilingKey": 0}
{"case_name": "moe_distribute_combine_test_tiling_shared_expert_x_1", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [64, 7168], "origin_shape": [64, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 7], "origin_shape": [8, 7]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [16384], "origin_shape": [16384]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8], "origin_shape": [8]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [8, 7], "origin_shape": [8, 7]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [1], "origin_shape": [1]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 8}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 8}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 1}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 0}, {"name": "shared_expert_rank_num", "type": "int64", "value": 0}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": true, "expectTilingKey": 10000}
{"case_name": "moe_distribute_combine_test_tiling_shared_expert_x_three_dims", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [64, 7168], "origin_shape": [64, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 7], "origin_shape": [8, 7]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8192], "origin_shape": [8192]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8], "origin_shape": [8]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [8, 7], "origin_shape": [8, 7]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [1], "origin_shape": [1]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [2, 4, 7168], "origin_shape": [2, 4, 7168]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 8}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 8}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 1}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 0}, {"name": "shared_expert_rank_num", "type": "int64", "value": 0}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": true, "expectTilingKey": 10000}
{"case_name": "moe_distribute_combine_test_tiling_0", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [64, 7168], "origin_shape": [64, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 7], "origin_shape": [8, 7]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [16384], "origin_shape": [16384]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8], "origin_shape": [8]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [8, 7], "origin_shape": [8, 7]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [1], "origin_shape": [1]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 8}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 7}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 1}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 1}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": true, "expectTilingKey": 10000}
{"case_name": "moe_distribute_combine_test_tiling_1", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [576, 7160], "origin_shape": [576, 7160]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [16, 8], "origin_shape": [16, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [288], "origin_shape": [288]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [2], "origin_shape": [2]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [32, 7160], "origin_shape": [32, 7160]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 288}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 256}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 2}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 32}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": false, "expectTilingKey": 0}
{"case_name": "moe_distribute_combine_test_tiling_2", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [576, 7160], "origin_shape": [576, 7160]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [16, 8], "origin_shape": [16, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [288], "origin_shape": [288]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [2], "origin_shape": [2]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [32, 7160], "origin_shape": [32, 7160]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 288}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 256}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 2}, {"name": "tp_rank_id", "type": "int64", "value": 1024}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 32}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": false, "expectTilingKey": 0}
{"case_name": "moe_distribute_combine_test_tiling_3", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [576, 7160], "origin_shape": [576, 7160]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [16, 8], "origin_shape": [16, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [288], "origin_shape": [288]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [2], "origin_shape": [2]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [32, 7160], "origin_shape": [32, 7160]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 288}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 256}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 2}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 31}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": false, "expectTilingKey": 0}
{"case_name": "moe_distribute_combine_test_tiling_ep_world_size_384", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [576, 7168], "origin_shape": [576, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [288], "origin_shape": [288]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [2], "origin_shape": [2]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [32, 7168], "origin_shape": [32, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 384}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 256}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 2}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 32}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": false, "expectTilingKey": 0}
{"case_name": "moe_distribute_combine_test_tiling_ep_world_size_72", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [576, 7168], "origin_shape": [576, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [288], "origin_shape": [288]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [2], "origin_shape": [2]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [32, 7168], "origin_shape": [32, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 72}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 216}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 2}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 32}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": false, "expectTilingKey": 0}
{"case_name": "moe_distribute_combine_test_tiling_x_activate_mask_2dims", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [576, 7168], "origin_shape": [576, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [288], "origin_shape": [288]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [2], "origin_shape": [2]}, {"dtype": "ge::DT_BOOL", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT64", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [32, 7168], "origin_shape": [32, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 72}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 216}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 2}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 18}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": false, "expectTilingKey": 0}
{"case_name": "moe_distribute_combine_test_tiling_elastic_info", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [576, 7168], "origin_shape": [576, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [288], "origin_shape": [288]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [2], "origin_shape": [2]}, {"dtype": "ge::DT_BOOL", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT64", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [288], "origin_shape": [288]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [32, 7168], "origin_shape": [32, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 72}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 216}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 2}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 18}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": false, "expectTilingKey": 0}
{"case_name": "moe_distribute_combine_test_tiling_moepp", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [576, 7168], "origin_shape": [576, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [288], "origin_shape": [288]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [2], "origin_shape": [2]}, {"dtype": "ge::DT_BOOL", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT64", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [148], "origin_shape": [148]}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [32, 7168], "origin_shape": [32, 7168]}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [6], "origin_shape": [6]}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [6], "origin_shape": [6]}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [6, 7168], "origin_shape": [6, 7168]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [32, 7168], "origin_shape": [32, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 72}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 216}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 2}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 18}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 6}, {"name": "copy_expert_num", "type": "int64", "value": 6}, {"name": "const_expert_num", "type": "int64", "value": 6}], "hasExpectTilingKey": false, "expectTilingKey": 0}
{"case_name": "moe_distribute_combine_test_tiling_copyExpert_without_OriX", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [576, 7168], "origin_shape": [576, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [288], "origin_shape": [288]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [2], "origin_shape": [2]}, {"dtype": "ge::DT_BOOL", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT64", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [148], "origin_shape": [148]}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [6], "origin_shape": [6]}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [6], "origin_shape": [6]}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [6, 7168], "origin_shape": [6, 7168]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [32, 7168], "origin_shape": [32, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 72}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 216}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 2}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 18}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 6}, {"name": "copy_expert_num", "type": "int64", "value": 6}, {"name": "const_expert_num", "type": "int64", "value": 6}], "hasExpectTilingKey": false, "expectTilingKey": 0}
{"case_name": "moe_distribute_combine_test_tiling_constExpert_without_OriX", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [576, 7168], "origin_shape": [576, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [288], "origin_shape": [288]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [2], "origin_shape": [2]}, {"dtype": "ge::DT_BOOL", "format": "ge::FORMAT_ND", "storage_shape": [32, 8], "origin_shape": [32, 8]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT64", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [148], "origin_shape": [148]}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [], "origin_shape": []}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [6], "origin_shape": [6]}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [6], "origin_shape": [6]}, {"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [6, 7168], "origin_shape": [6, 7168]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [32, 7168], "origin_shape": [32, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 72}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 216}, {"name": "group_tp", "type": "string", "value": "tp_group"}, {"name": "tp_world_size", "type": "int64", "value": 2}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 18}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": false, "expectTilingKey": 0}
{"case_name": "moe_distribute_combine_test_tiling_a2_commalg_empty", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [2048, 7168], "origin_shape": [2048, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [64], "origin_shape": [64]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [1], "origin_shape": [1]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 32}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 256}, {"name": "group_tp", "type": "string", "value": ""}, {"name": "tp_world_size", "type": "int64", "value": 0}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 32}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": true, "expectTilingKey": 2000}
{"case_name": "moe_distribute_combine_test_tiling_a2_commalg_empty_with_env", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [2048, 7168], "origin_shape": [2048, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [64], "origin_shape": [64]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [1], "origin_shape": [1]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 32}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 256}, {"name": "group_tp", "type": "string", "value": ""}, {"name": "tp_world_size", "type": "int64", "value": 0}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 32}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": true, "expectTilingKey": 2000}
{"case_name": "moe_distribute_combine_test_tiling_a2_commalg_fullmesh", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [2048, 7168], "origin_shape": [2048, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [64], "origin_shape": [64]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [1], "origin_shape": [1]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 32}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 256}, {"name": "group_tp", "type": "string", "value": ""}, {"name": "tp_world_size", "type": "int64", "value": 0}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 32}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": "fullmesh"}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": true, "expectTilingKey": 2000}
{"case_name": "moe_distribute_combine_test_tiling_a2_commalg_fullmesh_with_env", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [2048, 7168], "origin_shape": [2048, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [64], "origin_shape": [64]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [1], "origin_shape": [1]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 32}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 256}, {"name": "group_tp", "type": "string", "value": ""}, {"name": "tp_world_size", "type": "int64", "value": 0}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 32}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": "fullmesh"}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": true, "expectTilingKey": 2000}
{"case_name": "moe_distribute_combine_test_tiling_a2_commalg_hierarchy", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [2048, 7168], "origin_shape": [2048, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [64], "origin_shape": [64]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [1], "origin_shape": [1]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 32}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 256}, {"name": "group_tp", "type": "string", "value": ""}, {"name": "tp_world_size", "type": "int64", "value": 0}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 32}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": "hierarchy"}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": true, "expectTilingKey": 3000}
{"case_name": "moe_distribute_combine_test_tiling_a2_commalg_error", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [2048, 7168], "origin_shape": [2048, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [64], "origin_shape": [64]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [1], "origin_shape": [1]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 32}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 256}, {"name": "group_tp", "type": "string", "value": ""}, {"name": "tp_world_size", "type": "int64", "value": 0}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 32}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": "error"}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": false, "expectTilingKey": 0}
{"case_name": "moe_distribute_combine_test_tiling_a2_commalg_empty_with_env_commint8", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [2048, 7168], "origin_shape": [2048, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [64], "origin_shape": [64]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [1], "origin_shape": [1]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 32}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 256}, {"name": "group_tp", "type": "string", "value": ""}, {"name": "tp_world_size", "type": "int64", "value": 0}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 32}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 0}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": ""}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": true, "expectTilingKey": 2000}
{"case_name": "moe_distribute_combine_test_tiling_a2_commalg_hierarchy_commint8", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "inputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [2048, 7168], "origin_shape": [2048, 7168]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [64], "origin_shape": [64]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [256], "origin_shape": [256]}, {"dtype": "ge::DT_FLOAT", "format": "ge::FORMAT_ND", "storage_shape": [1], "origin_shape": [1]}, {"dtype": "ge::DT_INT32", "format": "ge::FORMAT_ND", "storage_shape": [8, 8], "origin_shape": [8, 8]}], "outputs": [{"dtype": "ge::DT_FLOAT16", "format": "ge::FORMAT_ND", "storage_shape": [8, 7168], "origin_shape": [8, 7168]}], "attrs": [{"name": "group_ep", "type": "string", "value": "ep_group"}, {"name": "ep_world_size", "type": "int64", "value": 32}, {"name": "ep_rank_id", "type": "int64", "value": 0}, {"name": "moe_expert_num", "type": "int64", "value": 256}, {"name": "group_tp", "type": "string", "value": ""}, {"name": "tp_world_size", "type": "int64", "value": 0}, {"name": "tp_rank_id", "type": "int64", "value": 0}, {"name": "expert_shard_type", "type": "int64", "value": 0}, {"name": "shared_expert_num", "type": "int64", "value": 1}, {"name": "shared_expert_rank_num", "type": "int64", "value": 32}, {"name": "global_bs", "type": "int64", "value": 0}, {"name": "out_dtype", "type": "int64", "value": 0}, {"name": "comm_quant_mode", "type": "int64", "value": 2}, {"name": "group_list_type", "type": "int64", "value": 0}, {"name": "comm_alg", "type": "string", "value": "hierarchy"}, {"name": "zero_expert_num", "type": "int64", "value": 0}, {"name": "copy_expert_num", "type": "int64", "value": 0}, {"name": "const_expert_num", "type": "int64", "value": 0}], "hasExpectTilingKey": true, "expectTilingKey": 3100}
