{"case_name": "moe_distribute_combine_test_tiling_0", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "input0_shape": [64, 7168], "input1_shape": [8, 7], "input2_shape": [56], "input3_shape": [8], "input4_shape": [8, 7], "input5_shape": [1], "output_shape": [8, 7168], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_FLOAT", "input5_dtype": "ge::DT_INT32", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "tp_group", "ep_world_size": 8, "tp_world_size": 1, "ep_rank_id": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 1, "moe_expert_num": 7, "global_bs": 0, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": true, "expect_tiling_key": 1000}
{"case_name": "moe_distribute_combine_test_tiling_1", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "input0_shape": [576, 7160], "input1_shape": [16, 8], "input2_shape": [256], "input3_shape": [288], "input4_shape": [2], "input5_shape": [32, 8], "output_shape": [32, 7160], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_INT32", "input5_dtype": "ge::DT_FLOAT", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "tp_group", "ep_world_size": 288, "tp_world_size": 2, "ep_rank_id": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 32, "moe_expert_num": 256, "global_bs": 0, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": false, "expect_tiling_key": 0}
{"case_name": "moe_distribute_combine_test_tiling_2", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "input0_shape": [576, 7160], "input1_shape": [16, 8], "input2_shape": [256], "input3_shape": [288], "input4_shape": [2], "input5_shape": [32, 8], "output_shape": [32, 7160], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_INT32", "input5_dtype": "ge::DT_FLOAT", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "tp_group", "ep_world_size": 288, "tp_world_size": 2, "ep_rank_id": 0, "tp_rank_id": 1024, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 32, "moe_expert_num": 256, "global_bs": 0, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": false, "expect_tiling_key": 0}
{"case_name": "moe_distribute_combine_test_tiling_3", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "input0_shape": [576, 7160], "input1_shape": [16, 8], "input2_shape": [256], "input3_shape": [288], "input4_shape": [2], "input5_shape": [32, 8], "output_shape": [32, 7160], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_INT32", "input5_dtype": "ge::DT_FLOAT", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "tp_group", "ep_world_size": 288, "tp_world_size": 2, "ep_rank_id": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 31, "moe_expert_num": 256, "global_bs": 0, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": false, "expect_tiling_key": 0}
{"case_name": "moe_distribute_combine_test_tiling_A2", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "input0_shape": [2048, 7168], "input1_shape": [8, 8], "input2_shape": [64], "input3_shape": [256], "input4_shape": [1], "input5_shape": [8, 8], "output_shape": [8, 7168], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_INT32", "input5_dtype": "ge::DT_FLOAT", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "", "ep_world_size": 32, "tp_world_size": 0, "ep_rank_id": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 32, "moe_expert_num": 256, "global_bs": 0, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": true, "expect_tiling_key": 2000}
{"case_name": "moe_distribute_combine_test_tiling_A2_layered", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "input0_shape": [2048, 7168], "input1_shape": [8, 8], "input2_shape": [64], "input3_shape": [256], "input4_shape": [1], "input5_shape": [8, 8], "output_shape": [8, 7168], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_INT32", "input5_dtype": "ge::DT_FLOAT", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "", "ep_world_size": 32, "tp_world_size": 0, "ep_rank_id": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 32, "moe_expert_num": 256, "global_bs": 0, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": true, "expect_tiling_key": 2000}
{"case_name": "moe_distribute_combine_test_tiling_A2_global_bs", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "input0_shape": [2048, 7168], "input1_shape": [8, 8], "input2_shape": [64], "input3_shape": [256], "input4_shape": [8, 8], "input5_shape": [1], "output_shape": [8, 7168], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_FLOAT", "input5_dtype": "ge::DT_INT32", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "", "ep_world_size": 32, "tp_world_size": 0, "ep_rank_id": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 0, "moe_expert_num": 256, "global_bs": 512, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": true, "expect_tiling_key": 2000}
{"case_name": "moe_distribute_combine_test_tiling_A2_shape", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "input0_shape": [2048, 7160], "input1_shape": [8, 8], "input2_shape": [64], "input3_shape": [256], "input4_shape": [1], "input5_shape": [8, 8], "output_shape": [8, 7168], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_INT32", "input5_dtype": "ge::DT_FLOAT", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "", "ep_world_size": 32, "tp_world_size": 0, "ep_rank_id": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 0, "moe_expert_num": 256, "global_bs": 0, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": false, "expect_tiling_key": 0}
{"case_name": "moe_distribute_combine_test_tiling_A2_ep_rankId", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "input0_shape": [2048, 7168], "input1_shape": [8, 8], "input2_shape": [64], "input3_shape": [256], "input4_shape": [0], "input5_shape": [8, 8], "output_shape": [8, 7168], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_INT32", "input5_dtype": "ge::DT_FLOAT", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "", "ep_world_size": 32, "tp_world_size": 0, "ep_rank_id": 33, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 0, "moe_expert_num": 256, "global_bs": 0, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": false, "expect_tiling_key": 0}
{"case_name": "moe_distribute_combine_test_tiling_A2_moe_expert_num", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "input0_shape": [2048, 7168], "input1_shape": [8, 8], "input2_shape": [64], "input3_shape": [256], "input4_shape": [1], "input5_shape": [8, 8], "output_shape": [8, 7168], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_INT32", "input5_dtype": "ge::DT_FLOAT", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "", "ep_world_size": 32, "tp_world_size": 0, "ep_rank_id": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 0, "moe_expert_num": 257, "global_bs": 0, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": false, "expect_tiling_key": 0}
{"case_name": "moe_distribute_combine_test_tiling_ep_world_size_384", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "input0_shape": [576, 7168], "input1_shape": [32, 8], "input2_shape": [256], "input3_shape": [288], "input4_shape": [32, 8], "input5_shape": [2], "output_shape": [32, 7168], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_FLOAT", "input5_dtype": "ge::DT_INT32", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "tp_group", "ep_world_size": 384, "tp_world_size": 2, "ep_rank_id": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 32, "moe_expert_num": 256, "global_bs": 0, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": false, "expect_tiling_key": 0}
{"case_name": "moe_distribute_combine_test_tiling_ep_world_size_72", "soc_version": "Ascend910_93", "coreNum": 20, "ubSize": 196608, "input0_shape": [576, 7168], "input1_shape": [32, 8], "input2_shape": [256], "input3_shape": [288], "input4_shape": [32, 8], "input5_shape": [2], "output_shape": [32, 7168], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_FLOAT", "input5_dtype": "ge::DT_INT32", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "tp_group", "ep_world_size": 72, "tp_world_size": 2, "ep_rank_id": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 18, "moe_expert_num": 216, "global_bs": 0, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": false, "expect_tiling_key": 0}
{"case_name": "moe_distribute_combine_test_tiling_A2_int8_quant", "soc_version": "Ascend910B", "coreNum": 48, "ubSize": 196608, "input0_shape": [2048, 7168], "input1_shape": [8, 8], "input2_shape": [64], "input3_shape": [256], "input4_shape": [1], "input5_shape": [8, 8], "output_shape": [8, 7168], "input0_dtype": "ge::DT_FLOAT16", "input1_dtype": "ge::DT_INT32", "input2_dtype": "ge::DT_INT32", "input3_dtype": "ge::DT_INT32", "input4_dtype": "ge::DT_INT32", "input5_dtype": "ge::DT_FLOAT", "output_dtype": "ge::DT_FLOAT16", "ep_group": "ep_group", "tp_group": "", "ep_world_size": 32, "tp_world_size": 0, "ep_rank_id": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 1, "shared_expert_rank_num": 32, "moe_expert_num": 256, "global_bs": 0, "out_dtype": 0, "comm_quant_mode": 0, "group_list_type": 0, "has_expect_tiling_key": true, "expect_tiling_key": 2000}
